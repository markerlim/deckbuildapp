import React, { useEffect, useRef, useState } from "react";
import { useAuth } from "../context/AuthContext";
import { db } from "../Firebase";
import { doc, getDoc, updateDoc, arrayRemove } from "firebase/firestore";
import { Link } from "react-router-dom";
import { Box, ButtonBase, CircularProgress, IconButton } from "@mui/material";
import { Star } from "@mui/icons-material";

const HomepageDashboard = () => {
  const [favorites, setFavorites] = useState([]);
  const [isLoading, setIsLoading] = useState(true);
  const { currentUser } = useAuth();
  const [justifyContent, setJustifyContent] = useState('flex-start');
  const boxRef = useRef(null);
  const [showPopup, setShowPopup] = useState(false);
  const [dontShowAgain, setDontShowAgain] = useState(false);
  const digimon = "digimon/";
  const uacard = "unionarena/";
  const onepiece = "onepiece/";

  useEffect(() => {
    if (!localStorage.getItem("popupShown")) {
      setShowPopup(true);
    }
  }, []);

  const handleClosePopup = () => {
    setShowPopup(false);
    if (dontShowAgain) {
      localStorage.setItem("popupShown", "true");
    }
  };


  useEffect(() => {
    const handleResize = () => {
      if (!boxRef.current) return;

      let childWidth = 0;
      for (let child of boxRef.current.children) {
        childWidth += child.getBoundingClientRect().width;
      }

      if (childWidth > boxRef.current.getBoundingClientRect().width) {
        setJustifyContent('flex-start');
      } else {
        setJustifyContent('center');
      }
    }

    handleResize();

    window.addEventListener('resize', handleResize);

    return () => {
      window.removeEventListener('resize', handleResize);
    }
  }, [favorites]);

  const fetchFavorites = async () => {
    try {
      const docRef = doc(db, "users", currentUser.uid);
      const docSnapshot = await getDoc(docRef);

      if (docSnapshot.exists()) {
        const userData = docSnapshot.data();
        setFavorites(userData.favorites || []);
      }
    } catch (error) {
      console.error("Error fetching favorites:", error);
    } finally {
      setIsLoading(false); // Setting the loading state to false after fetching
    }
  };

  useEffect(() => {
    if (currentUser) {
      fetchFavorites();
    } else {
      setIsLoading(false);
    }
  }, [currentUser]);

  const handleFavorite = async (favorite) => {
    try {
      const userDocRef = doc(db, "users", currentUser.uid);

      // Get current user document snapshot
      const docSnap = await getDoc(userDocRef);
      // Extract current favorites
      const currentFavorites = docSnap.data().favorites || [];
      // Find the favorite to be removed
      const favoriteToRemove = currentFavorites.find(
        (fav) =>
          fav.pathname === favorite.pathname &&
          fav.alt === favorite.alt &&
          fav.imageSrc === favorite.imageSrc &&
          fav.imgWidth === favorite.imgWidth
      );

      if (favoriteToRemove) {
        await updateDoc(userDocRef, {
          favorites: arrayRemove(favoriteToRemove),
        });

        setFavorites(currentFavorites.filter((fav) => fav !== favoriteToRemove));
      }
    } catch (error) {
      console.error("Error removing from favorites:", error);
    }
  };


  return (
    <>
      {showPopup && (
        <div style={{ position: 'fixed', top: 0, left: 0, width: '100%', height: '100%', backgroundColor: 'rgba(0, 0, 0, 0.7)', display: 'flex', justifyContent: 'center', alignItems: 'center', zIndex: 1000 }}>
          <div style={{ backgroundColor: '#26252d', padding: '20px', borderRadius: '10px', maxWidth: '400px', textAlign: 'start', display: 'flex', flexDirection: 'column', gap: '10px' }}>
            <p style={{fontSize:'15px'}}>Hi all, please start using <a href="www.geekstack.dev">www.geekstack.dev</a> instead of www.uniondeck.dev if you have not! :D
            <br/>We use discord for communication, tiktok for sharing video guides on navigating the website and buy me a coffee for donations.
            </p>
            <Box sx={{ color: "#ffffff", display: 'flex', flexDirection: 'row', gap: '10px',justifyContent:'end',background:"url(images/articlebg/JJKBG.jpg)",padding:'10px' }}>
              <Box sx={{ display: { xs: 'flex', sm: 'flex', md: 'none' }, flexDirection: 'row', gap: '10px', justifyContent: 'center', alignItems: 'center' }}>
                <Box component={Link} to="https://discord.gg/wUZCZB9aM3" className="socialmediabtn">
                  <svg xmlns="http://www.w3.org/2000/svg" width="22" height="17" viewBox="0 0 22 17" fill="none">
                    <path d="M18.6361 1.42375C17.212 0.758625 15.6893 0.275242 14.0973 0C13.9018 0.352851 13.6734 0.827443 13.5159 1.20498C11.8236 0.95093 10.1469 0.95093 8.48573 1.20498C8.32828 0.827443 8.09467 0.352851 7.89741 0C6.30374 0.275242 4.77928 0.760401 3.35518 1.42727C0.482756 5.76019 -0.29591 9.98549 0.0934236 14.1508C1.99856 15.571 3.84487 16.4337 5.66003 16.9983C6.1082 16.3825 6.50791 15.728 6.85224 15.0382C6.19644 14.7895 5.56832 14.4825 4.97482 14.1261C5.13227 14.0097 5.28628 13.8879 5.43508 13.7627C9.05501 15.4528 12.9882 15.4528 16.5648 13.7627C16.7154 13.8879 16.8694 14.0097 17.0251 14.1261C16.4299 14.4842 15.8 14.7912 15.1442 15.04C15.4885 15.728 15.8865 16.3843 16.3364 17C18.1533 16.4355 20.0014 15.5728 21.9065 14.1508C22.3633 9.32214 21.1261 5.13565 18.6361 1.42375ZM7.34541 11.5892C6.25874 11.5892 5.36759 10.5765 5.36759 9.34331C5.36759 8.11012 6.23972 7.0957 7.34541 7.0957C8.45114 7.0957 9.34226 8.10835 9.32323 9.34331C9.32495 10.5765 8.45114 11.5892 7.34541 11.5892ZM14.6545 11.5892C13.5678 11.5892 12.6767 10.5765 12.6767 9.34331C12.6767 8.11012 13.5488 7.0957 14.6545 7.0957C15.7602 7.0957 16.6514 8.10835 16.6323 9.34331C16.6323 10.5765 15.7602 11.5892 14.6545 11.5892Z" fill="#C8A2C8" />
                  </svg>
                </Box>
                <Box component={Link} to="https://www.tiktok.com/@geekstackapp" className="socialmediabtn">
                  <svg xmlns="http://www.w3.org/2000/svg" width="15" height="17" viewBox="0 0 15 17" fill="none">
                    <path d="M7.87814 0.0141733C8.82047 5.38556e-08 9.75589 0.00737011 10.6907 0C10.7218 1.15144 11.1961 2.18779 11.9508 2.95541L11.9497 2.95428C12.7619 3.67485 13.8188 4.142 14.9839 4.22137L15 4.2225V7.07757C13.8994 7.05036 12.8644 6.80034 11.9312 6.37061L11.9784 6.38988C11.5271 6.17615 11.1455 5.95675 10.7828 5.71183L10.8128 5.73111C10.8059 7.79984 10.8197 9.86857 10.7984 11.9299C10.7391 12.9805 10.3845 13.9386 9.81575 14.7385L9.82727 14.7209C8.8763 16.0623 7.33588 16.9427 5.5842 16.9949H5.57614C5.50534 16.9983 5.42187 17 5.33782 17C4.34196 17 3.41114 16.7267 2.61791 16.2522L2.64093 16.2653C1.19722 15.4098 0.201355 13.9459 0.0171494 12.2434L0.0148469 12.2202C0.000455796 11.8659 -0.00645198 11.5115 0.00793912 11.1646C0.290004 8.45521 2.59488 6.35927 5.39654 6.35927C5.71142 6.35927 6.01996 6.38591 6.31987 6.43637L6.28763 6.43184C6.30203 7.48009 6.25885 8.52891 6.25885 9.57717C6.01536 9.49043 5.73444 9.43997 5.44144 9.43997C4.36614 9.43997 3.45144 10.1169 3.11296 11.062L3.10778 11.079C3.03122 11.321 2.9869 11.5994 2.9869 11.8874C2.9869 12.0042 2.99438 12.1199 3.00819 12.2332L3.00704 12.2196C3.19816 13.3796 4.20784 14.2549 5.42532 14.2549C5.46044 14.2549 5.49497 14.2544 5.52951 14.2527H5.52433C6.3665 14.2277 7.09757 13.7815 7.51088 13.1222L7.51663 13.112C7.67033 12.9011 7.77567 12.646 7.81079 12.3687L7.81136 12.3608C7.88332 11.0926 7.85454 9.83172 7.86145 8.5635C7.86835 5.70843 7.85454 2.86017 7.87584 0.0124725L7.87814 0.0141733Z" fill="#C8A2C8" />
                  </svg>
                </Box>
                <Box component={Link} to="https://www.buymeacoffee.com/uniondeck" className="socialmediabtn">
                  <svg xmlns="http://www.w3.org/2000/svg" width="12" height="17" viewBox="0 0 12 17" fill="none">
                    <path d="M11.9466 4.54402L11.851 4.07226C11.7649 3.64867 11.5702 3.24845 11.1265 3.09545C10.984 3.04657 10.8226 3.02603 10.714 2.92474C10.604 2.82344 10.5721 2.66548 10.5468 2.51956C10.4998 2.25181 10.4563 1.98405 10.4078 1.717C10.3666 1.48679 10.334 1.22825 10.2269 1.01787C10.0858 0.734528 9.7948 0.568775 9.50602 0.459689C9.3578 0.40545 9.20653 0.359569 9.05294 0.32227C8.32917 0.135975 7.56922 0.0672652 6.82591 0.0275978C5.93334 -0.0204325 5.0384 -0.00575565 4.14797 0.0715153C3.48573 0.130308 2.78729 0.201851 2.15761 0.425689C1.92746 0.507857 1.69006 0.607025 1.51491 0.78057C1.29995 0.994491 1.23047 1.326 1.3868 1.59234C1.49826 1.78146 1.68717 1.91534 1.88765 2.00318C2.14821 2.11793 2.42107 2.20435 2.70044 2.26243C3.47849 2.43102 4.28477 2.49689 5.07946 2.52452C5.96101 2.55994 6.84328 2.5316 7.72121 2.44094C7.93762 2.41756 8.15402 2.38923 8.3697 2.35664C8.62447 2.31839 8.78804 1.99326 8.71277 1.76588C8.62302 1.49458 8.38201 1.38975 8.10915 1.43083C7.77187 1.48325 7.41433 1.50733 7.1089 1.53425C6.25703 1.59092 5.40226 1.59234 4.54966 1.5385C4.2699 1.52038 3.99068 1.49511 3.71227 1.46271C3.65002 1.45562 3.58199 1.445 3.52553 1.43721C3.34966 1.41171 3.17523 1.38054 3.00153 1.34512C2.92119 1.326 2.92119 1.21408 3.00153 1.19495H3.00515C3.20563 1.15245 3.40828 1.11845 3.61166 1.09083H3.61311C3.70792 1.08445 3.80346 1.06816 3.89827 1.05683C4.72187 0.973166 5.55034 0.944766 6.3779 0.971824C6.86572 0.985283 7.35281 1.01928 7.83774 1.07383L8.00276 1.09578C8.196 1.12412 8.38852 1.15812 8.58032 1.19849C8.86404 1.2587 9.22809 1.27854 9.35475 1.58242C9.39456 1.67946 9.41265 1.78642 9.43509 1.88772L9.66597 2.9389C9.67087 2.96144 9.67097 2.98473 9.66627 3.00731C9.66157 3.02989 9.65218 3.05128 9.63867 3.07015C9.62516 3.08902 9.60782 3.10497 9.58774 3.117C9.56766 3.12903 9.54526 3.13688 9.52194 3.14007H9.51977C9.49299 3.14432 9.46549 3.14716 9.43871 3.1507C8.30025 3.29285 7.15357 3.36265 6.00588 3.35966C4.86871 3.35851 3.73275 3.28659 2.6049 3.14432C2.50358 3.13228 2.39284 3.11457 2.30309 3.10182C2.06714 3.06782 1.83337 3.02532 1.59887 2.98778C1.31443 2.94174 1.04301 2.96511 0.786077 3.10182C0.576185 3.21516 0.404652 3.38799 0.297534 3.59837C0.186074 3.82221 0.153505 4.06588 0.104289 4.30672C0.0543488 4.54756 -0.0230942 4.80752 0.0065802 5.05473C0.0695479 5.58812 0.450249 6.02163 0.998141 6.11867C3.70754 6.59189 6.47236 6.68159 9.20783 6.38501C9.2598 6.37922 9.31243 6.38492 9.36185 6.40169C9.41127 6.41846 9.45622 6.44586 9.49337 6.48189C9.53053 6.51792 9.55896 6.56165 9.57655 6.60985C9.59415 6.65806 9.60047 6.70952 9.59504 6.76043L9.54365 7.25415L8.80686 14.2717C8.77719 14.5622 8.77284 14.8611 8.71639 15.148C8.62809 15.5992 8.31615 15.8761 7.8609 15.9774C7.44328 16.0702 7.01771 16.1191 6.58996 16.1227C6.11517 16.1255 5.64183 16.1049 5.16704 16.1071C4.66112 16.1099 4.04086 16.0646 3.65075 15.6962C3.30696 15.3718 3.25991 14.8646 3.21287 14.4262L2.68379 9.45853L2.45074 7.2669C2.42396 7.01827 2.24374 6.7746 1.96003 6.78664C1.71684 6.79727 1.44036 6.99915 1.46931 7.26761L1.63433 8.81535L2.32119 15.2698C2.42758 16.2218 3.17089 16.7347 4.09152 16.8792C4.62855 16.9642 5.17934 16.9812 5.72506 16.9897C6.42422 17.001 7.13062 17.0272 7.81819 16.9033C8.83726 16.7205 9.60228 16.0546 9.71157 15.0212C9.95765 12.661 10.2059 10.3015 10.4527 7.94125L10.6083 6.46293C10.616 6.38962 10.6476 6.32068 10.6984 6.26633C10.7493 6.21197 10.8166 6.1751 10.8906 6.16117C11.1815 6.10592 11.4602 6.011 11.6679 5.79425C11.9972 5.44858 12.0631 4.99878 11.9466 4.54402ZM10.8768 5.09086C10.7719 5.1879 10.6141 5.23324 10.4585 5.25591C8.70988 5.5102 6.93665 5.63841 5.16921 5.58174C3.90406 5.53924 2.65267 5.40182 1.40055 5.22899C1.27751 5.21199 1.14507 5.19003 1.06038 5.10149C0.901156 4.93432 0.980046 4.59856 1.0213 4.39668C1.05894 4.21251 1.13131 3.9653 1.35641 3.93909C1.70671 3.89871 2.11347 4.04392 2.46087 4.09492C2.87849 4.15726 3.29755 4.20755 3.71806 4.24509C5.513 4.40518 7.33834 4.37968 9.12604 4.14593C9.45174 4.10342 9.77671 4.05384 10.0995 3.99717C10.3883 3.94617 10.7075 3.85125 10.8812 4.14309C11.0013 4.34214 11.0172 4.60848 10.9984 4.83302C10.9927 4.93108 10.949 5.02331 10.8761 5.09086H10.8768ZM6.41915 7.85341C5.79527 8.1155 5.08742 8.41159 4.16896 8.41159C3.78508 8.41068 3.40309 8.35897 3.03337 8.25788L3.66812 14.6358C3.71516 15.1883 4.18706 15.6133 4.75377 15.6133C4.75377 15.6133 5.65341 15.6594 5.95377 15.6594C6.2773 15.6594 7.24642 15.6133 7.24642 15.6133C7.81313 15.6133 8.2843 15.1883 8.33135 14.6358L9.01169 7.58778C8.70475 7.47915 8.38124 7.42215 8.05487 7.4192C7.45703 7.4192 6.97573 7.62037 6.41915 7.85341Z" fill="#C8A2C8" />
                  </svg>
                </Box>
              </Box>
              <Box sx={{ display: { xs: 'none', sm: 'none', md: 'flex' }, flexDirection: 'row', gap: '10px', justifyContent: 'center', alignItems: 'center' }}>
                <Box component={Link} to="https://discord.gg/wUZCZB9aM3" className="socialmediabtn" id="socialmediabtnlarge">
                  <svg xmlns="http://www.w3.org/2000/svg" width="33" height="26" viewBox="0 0 33 26" fill="none">
                    <path d="M27.9541 2.17749C25.818 1.16025 23.5339 0.420959 21.146 0C20.8527 0.539654 20.5101 1.2655 20.2739 1.84291C17.7354 1.45436 15.2203 1.45436 12.7286 1.84291C12.4924 1.2655 12.142 0.539654 11.8461 0C9.45561 0.420959 7.16891 1.16297 5.03277 2.18288C0.724134 8.8097 -0.443865 15.2719 0.140135 21.6424C2.99785 23.8144 5.76731 25.1339 8.49004 25.9973C9.1623 25.0556 9.76186 24.0546 10.2784 22.9996C9.29466 22.6192 8.35248 22.1497 7.46223 21.6046C7.69841 21.4265 7.92943 21.2404 8.15262 21.0488C13.5825 23.6337 19.4822 23.6337 24.8473 21.0488C25.0731 21.2404 25.3041 21.4265 25.5377 21.6046C24.6448 22.1523 23.7 22.6218 22.7163 23.0023C23.2328 24.0546 23.8298 25.0584 24.5046 26C27.23 25.1366 30.002 23.8172 32.8597 21.6424C33.545 14.2574 31.6892 7.85452 27.9541 2.17749ZM11.0181 17.7246C9.38812 17.7246 8.05138 16.1758 8.05138 14.2898C8.05138 12.4037 9.35957 10.8522 11.0181 10.8522C12.6767 10.8522 14.0134 12.401 13.9848 14.2898C13.9874 16.1758 12.6767 17.7246 11.0181 17.7246ZM21.9818 17.7246C20.3518 17.7246 19.015 16.1758 19.015 14.2898C19.015 12.4037 20.3232 10.8522 21.9818 10.8522C23.6403 10.8522 24.977 12.401 24.9485 14.2898C24.9485 16.1758 23.6403 17.7246 21.9818 17.7246Z" fill="#C8A2C8" />
                  </svg>
                </Box>
                <Box component={Link} to="https://www.tiktok.com/@geekstackapp" className="socialmediabtn" id="socialmediabtnlarge">
                  <svg xmlns="http://www.w3.org/2000/svg" width="23" height="26" viewBox="0 0 23 26" fill="none">
                    <path d="M11.8666 0.0216769C13.286 8.23674e-08 14.6949 0.0112719 16.1031 0C16.1499 1.76102 16.8644 3.34603 18.0011 4.52004L17.9994 4.51831C19.2228 5.62036 20.8147 6.33482 22.5697 6.45621L22.594 6.45795V10.8245C20.9361 10.7829 19.3771 10.4005 17.9716 9.74328L18.0427 9.77276C17.3629 9.44587 16.7881 9.11032 16.2418 8.73574L16.2869 8.76522C16.2765 11.9292 16.2973 15.0931 16.2652 18.2458C16.1759 19.8525 15.6418 21.3178 14.7851 22.5413L14.8025 22.5144C13.3701 24.5659 11.0498 25.9124 8.41128 25.9922H8.39914C8.29249 25.9974 8.16676 26 8.04017 26C6.54014 26 5.13808 25.5821 3.94326 24.8563L3.97794 24.8763C1.80333 23.5679 0.303294 21.3291 0.0258316 18.7253L0.0223633 18.6897C0.00068655 18.1478 -0.00971838 17.6059 0.0119584 17.0752C0.436823 12.9315 3.90858 9.72594 8.12861 9.72594C8.6029 9.72594 9.06765 9.76669 9.5194 9.84386L9.47084 9.83692C9.49252 11.4401 9.42749 13.0442 9.42749 14.6474C9.06071 14.5148 8.63758 14.4376 8.19624 14.4376C6.57656 14.4376 5.19878 15.4729 4.68894 16.9183L4.68114 16.9443C4.56582 17.3145 4.49905 17.7403 4.49905 18.1808C4.49905 18.3594 4.51032 18.5363 4.53113 18.7097L4.5294 18.6889C4.81727 20.4629 6.33811 21.8016 8.17197 21.8016C8.22486 21.8016 8.27688 21.8008 8.32891 21.7982H8.3211C9.58963 21.76 10.6908 21.0776 11.3134 20.0692L11.322 20.0536C11.5535 19.7311 11.7122 19.3409 11.7651 18.9169L11.766 18.9048C11.8744 16.9651 11.831 15.0367 11.8414 13.0971C11.8518 8.73054 11.831 4.37437 11.8631 0.0190756L11.8666 0.0216769Z" fill="#C8A2C8" />
                  </svg>
                </Box>
                <Box component={Link} to="https://www.buymeacoffee.com/uniondeck" className="socialmediabtn" id="socialmediabtnlarge">
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="26" viewBox="0 0 18 26" fill="none">
                    <path d="M17.8819 6.94967L17.7389 6.22816C17.61 5.58031 17.3186 4.96822 16.6545 4.73421C16.4411 4.65946 16.1995 4.62805 16.037 4.47313C15.8723 4.31821 15.8246 4.07662 15.7867 3.85345C15.7163 3.44394 15.6513 3.03443 15.5787 2.62601C15.517 2.27392 15.4682 1.87849 15.3079 1.55674C15.0966 1.1234 14.6611 0.869891 14.2289 0.703054C14.007 0.620101 13.7806 0.549929 13.5507 0.492884C12.4673 0.207962 11.3298 0.102876 10.2172 0.0422084C8.88118 -0.0312497 7.54161 -0.00880276 6.2088 0.109376C5.21753 0.199295 4.17209 0.308713 3.22958 0.651053C2.88507 0.776722 2.52973 0.928392 2.26756 1.19381C1.9458 1.52099 1.8418 2.028 2.0758 2.43534C2.24264 2.72459 2.5254 2.92935 2.82549 3.06368C3.21549 3.23919 3.62392 3.37135 4.04209 3.46019C5.2067 3.71803 6.41355 3.81878 7.60308 3.86103C8.9226 3.9152 10.2432 3.87186 11.5573 3.7332C11.8812 3.69744 12.2052 3.65411 12.528 3.60428C12.9093 3.54577 13.1542 3.04852 13.0415 2.70076C12.9072 2.28583 12.5464 2.1255 12.138 2.18833C11.6332 2.2685 11.098 2.30533 10.6408 2.3465C9.36569 2.43317 8.08625 2.43534 6.81006 2.353C6.39131 2.32529 5.97335 2.28664 5.55662 2.23708C5.46345 2.22625 5.36162 2.21 5.27712 2.19808C5.01386 2.15908 4.75277 2.11141 4.49277 2.05725C4.37251 2.028 4.37251 1.85683 4.49277 1.82758H4.49818C4.79827 1.76257 5.10161 1.71057 5.40603 1.66832H5.4082C5.55012 1.65857 5.69312 1.63366 5.83504 1.61632C7.06782 1.48837 8.30791 1.44494 9.54661 1.48632C10.2768 1.5069 11.0059 1.5589 11.7317 1.64232L11.9787 1.67591C12.268 1.71924 12.5562 1.77124 12.8433 1.83299C13.2679 1.92508 13.8129 1.95541 14.0024 2.42017C14.062 2.56859 14.0891 2.73218 14.1227 2.8871L14.4683 4.49479C14.4756 4.52927 14.4758 4.56488 14.4687 4.59941C14.4617 4.63394 14.4476 4.66666 14.4274 4.69552C14.4072 4.72439 14.3812 4.74877 14.3512 4.76717C14.3211 4.78557 14.2876 4.79759 14.2527 4.80247H14.2495C14.2094 4.80897 14.1682 4.8133 14.1281 4.81872C12.424 5.03613 10.7077 5.14288 8.98977 5.13831C7.28761 5.13655 5.58729 5.02655 3.89909 4.80897C3.74742 4.79055 3.58167 4.76346 3.44733 4.74396C3.09416 4.69196 2.74423 4.62696 2.39323 4.56954C1.96747 4.49913 1.56121 4.53488 1.17662 4.74396C0.862449 4.9173 0.605694 5.18164 0.445357 5.5034C0.278521 5.84574 0.22977 6.21841 0.156102 6.58675C0.0813508 6.95509 -0.0345681 7.35268 0.00984942 7.73077C0.104101 8.54654 0.673945 9.20955 1.49404 9.35797C5.54954 10.0817 9.688 10.2189 13.7825 9.76531C13.8603 9.75646 13.9391 9.76518 14.0131 9.79082C14.087 9.81646 14.1543 9.85838 14.2099 9.91348C14.2656 9.96858 14.3081 10.0355 14.3344 10.1092C14.3608 10.1829 14.3702 10.2616 14.3621 10.3395L14.2852 11.0946L13.1823 21.8274C13.1379 22.2715 13.1314 22.7287 13.0469 23.1675C12.9148 23.8576 12.4478 24.2812 11.7664 24.4361C11.1413 24.578 10.5043 24.6528 9.86403 24.6582C9.15335 24.6625 8.44484 24.6311 7.73416 24.6343C6.9769 24.6387 6.04846 24.5693 5.46454 24.006C4.94994 23.5098 4.87952 22.7341 4.80911 22.0635L4.01718 14.466L3.66834 11.1141C3.62825 10.7338 3.3585 10.3612 2.93382 10.3796C2.56981 10.3958 2.15597 10.7046 2.19931 11.1152L2.44631 13.4823L3.47441 23.3538C3.63367 24.8098 4.74627 25.5942 6.1243 25.8152C6.92815 25.9452 7.75258 25.9712 8.56943 25.9842C9.61595 26.0015 10.6733 26.0416 11.7025 25.852C13.2278 25.5725 14.373 24.5542 14.5365 22.9736C14.9049 19.3638 15.2765 15.7552 15.6459 12.1454L15.8788 9.88448C15.8903 9.77236 15.9376 9.66692 16.0137 9.5838C16.0898 9.50067 16.1907 9.44427 16.3013 9.42297C16.7368 9.33847 17.1539 9.1933 17.4648 8.86179C17.9578 8.33312 18.0564 7.64519 17.8819 6.94967ZM16.2807 7.78602C16.1237 7.93444 15.8875 8.00378 15.6546 8.03844C13.0372 8.42737 10.383 8.62345 7.73741 8.53679C5.84371 8.47179 3.97059 8.26161 2.09639 7.99728C1.91222 7.97128 1.71396 7.93769 1.58721 7.80227C1.34887 7.5466 1.46696 7.03309 1.52871 6.72433C1.58505 6.44266 1.69338 6.06457 2.0303 6.02449C2.55465 5.96274 3.16349 6.18483 3.6835 6.26283C4.3086 6.35816 4.93586 6.43508 5.56529 6.4925C8.252 6.73734 10.9842 6.69833 13.6601 6.34083C14.1476 6.27583 14.634 6.19999 15.1172 6.11332C15.5495 6.03532 16.0272 5.89015 16.2872 6.33649C16.4671 6.64092 16.4909 7.04826 16.4627 7.39168C16.4542 7.54166 16.3887 7.68271 16.2797 7.78602H16.2807ZM9.60836 12.0111C8.67451 12.4119 7.61499 12.8648 6.24022 12.8648C5.66562 12.8634 5.09384 12.7843 4.54043 12.6297L5.49054 22.3842C5.56095 23.2292 6.2673 23.8792 7.11557 23.8792C7.11557 23.8792 8.46218 23.9497 8.91177 23.9497C9.39603 23.9497 10.8466 23.8792 10.8466 23.8792C11.6949 23.8792 12.4002 23.2292 12.4706 22.3842L13.4889 11.6048C13.0295 11.4387 12.5453 11.3515 12.0567 11.347C11.1619 11.347 10.4415 11.6547 9.60836 12.0111Z" fill="#C8A2C8" />
                  </svg>
                </Box>
              </Box>
            </Box>
            <Box>
              <Box sx={{ fontSize: { xs: '10px', sm: '10px', md: '15px' } }}>Should there be queries, you may find us on discord via Aegis or DPPChannel</Box>
              <Box sx={{ fontSize: { xs: '10px', sm: '10px', md: '15px' } }}>Disclaimer: Assets found on this websites are from Bandai we do not own any of it.</Box>
              <div style={{ fontSize: '10px', display: 'flex', alignItems: 'center', paddingBottom: '20px' }}>
                <input
                  style={{ width: '10px' }}
                  type="checkbox"
                  id="dontShowAgain"
                  checked={dontShowAgain}
                  onChange={() => setDontShowAgain(!dontShowAgain)}
                />
                <label htmlFor="dontShowAgain">Don't show this again</label>
              </div>
              <button style={{ backgroundColor: "#74cfff", paddingTop: '3px', paddingBottom: '3px', paddingRight: '8px', paddingLeft: '8px', borderRadius: '5px', cursor: 'pointer' }} onClick={handleClosePopup}>Okay</button>
            </Box>
          </div>
        </div>
      )}
      <Box ref={boxRef} sx={{ display: "flex", flexwrap: "nowrap", flex: "0 0 auto", flexDirection: "row", overflowX: "auto", overflowY: "hidden", justifyContent: justifyContent, width: "100%", paddingLeft: "15px", paddingRight: "15px", gap: "20px", height: { xs: 248, sm: 360 }, }}>
        {isLoading ? (
          <Box sx={{ display: 'flex', justifyContent: 'center', alignItems: 'center', height: '100%' }}>
            <CircularProgress />
          </Box>
        ) : favorites.length > 0 ? (
          favorites.map((favorite, index) => (
            <div key={index}>
              <Link to={{ pathname: `/${favorite.pathname}` }} sx={{ textDecoration: "none" }}>
                <ButtonBase
                  sx={{
                    display: "flex",
                    flexDirection: "column",
                    alignItems: "center",
                    bgcolor: "#121212",
                    borderRadius: "10px",
                    boxShadow: 5,
                    overflow: "hidden",
                    width: { xs: 125, sm: 200 },
                    height: { xs: 188, sm: 300 },
                  }}
                >
                  <img
                    src={favorite.imageSrc}
                    alt={favorite.alt}
                    style={{ width: `${favorite.imgWidth}`, height: "auto" }}
                  />
                </ButtonBase>
              </Link>
              <IconButton
                sx={{
                  color: favorites.includes(favorite) ? "#7C4FFF" : "white",
                }}
                onClick={() => handleFavorite(favorite)}
              >
                <Star />
                <span style={{ color: "#f2f3f8", textTransform: "uppercase" }}><strong>{favorite.pathname.replace(digimon, "").replace(uacard, "").replace(onepiece, "")}</strong></span>
              </IconButton>
            </div>
          ))
        ) : (
          <Box sx={{ height: { xs: 228, sm: 340 }, alignItems: "center", display: "flex", fontSize: "20px", fontWeight: "900" }}>
            <span style={{ padding: "30px", backgroundColor: "#240052", borderRadius: "10px" }}>You currently have no favourites. Do star them to add the pages to your favorite.</span>
          </Box>
        )}
      </Box>
    </>
  );
};

export default HomepageDashboard;
